" Tridactyl config
"
" Simon H Moore
"
" Required tridactly-native to be installed.
" Run `installnative` in tridactyl.

" Remove any existing settings.
sanitize tridactyllocal tridactylsync

"
" Alias
"
alias mpv js -p tri.excmds.shellescape(JS_ARG).then(url => tri.excmds.exclaim_quiet('mpv ' + url))
alias ytdl js -p tri.excmds.shellescape(JS_ARG).then(url => tri.excmds.exclaim_quiet('ytdl --notify --video --url=' + url))
alias ytdl_pl js -p tri.excmds.shellescape(JS_ARG).then(url => tri.excmds.exclaim_quiet('ytdl --notify --playlist --url=' + url))


"
" Settings
"

" Color theme to use for menu
colors dark

" Auto create containers 
" auconscreatecontainer true

" Characters to use for hints
" set hintchars hjklasdfgyuiopqwertnmzxcb
set hintchars hjklgftyuvbiondsrcm

" Editor
set editorcmd xst -e nvim -S $HOME/.config/nvim/after/ftplugin/tridactyl.vim

" Always open in new window
autocmd DocStart .* tabdetach


"
" Zoom levels
"
autocmd DocStart .* zoom 170
autocmd DocStart .*youtube\.com.* zoom 180
autocmd DocStart .*startpage\.com.* zoom 220
autocmd DocStart .*duckduckgo\.com.* zoom 200
autocmd DocStart .*github\.com.* zoom 200
autocmd DocStart .*gitlab\.com.* zoom 150
autocmd DocStart .*archlinux\.org.* zoom 200
autocmd DocStart .*amazon\.co\.uk.* zoom 150
autocmd DocStart .*wikipedia\.org.* zoom 200

"
" Other site optimizations
"

" Skip 'home' page for youtube channel and go straight to 'video'
autocmd DocStart .*youtube\.com/(c|channel|user)/[^/]*/?$ urlmodify -g 2 videos


"
" Bind Keys
"

" Close windows and tabs
bind q tabclose
bind Q winclose

" Duplicate current url in new window
unbind o
bind o composite get_current_url | winopen

" Find
bind / fillcmdline find
bind ? fillcmdline find -?
bind n findnext 1
bind N findnext -1

" Mute
bind m mute toggle
bind M mute all toggle

" Follow link
bind f hint -w
unbind t
bind t hint
" Open ling in new tab
unbind T
bind T hint -b

" Optomize follow link for URL's.
bindurl youtube.com f hint -Jw
bindurl youtube.com t hint -J

" Yank with hint
bind Y hint -y

" Play video with mpv
unbind v
unbind V
" On current URL
bind V composite get_current_url | mpv
" Using hint
bind v hint -JW mpv
" On youtube
bindurl youtube.com v composite hint -Jpipe ytd-thumbnail>a href | mpv


" Download video using youtube-dl
unbind d
unbind D
" On current URL
bind D composite get_current_url | ytdl
" Using hint
bind d hint -JW ytdl
" On Youtube
bindurl youtube.com d composite hint -Jpipe ytd-thumbnail>a href | ytdl
" Download playlist
bindurl youtube.com/playlist D composite get_current_url | ytdl_pl


" Git{Hub,Lab} git clone via SSH yank
bind yg composite js "git clone " + document.location.href.replace(/https?:\/\//,"git@").replace("/",":").replace(/$/,".git") | clipboard yank

" Autocontain
" autocontain google\.(co\.uk|com) google
" autocontain gmail.com google
