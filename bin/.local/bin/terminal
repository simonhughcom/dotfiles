#!/bin/sh

# TERMINAL
# Simon Hugh Moore
#
# Wrapper script for launching terminal

# Replace one cli command with another
_replace(){
    sed "s/[[:blank:]]*$1[[:blank:]][[:blank:]]*/ $2 /"
}

_alacritty(){
    # check for dependencies
    command -v alacritty > /dev/null || { echo "alacritty not found"; exit 1; }

    # cmd="$( echo "$@" | sed 's/[[:blank:]]*-c[[:blank:]][[:blank:]]*/ --class /' )"
    cmd="$( echo "$@" | _replace "-c" "--class" )"
    if [ "$HOST" = "mumtop" ]; then
        eval "LIBGL_ALWAYS_SOFTWARE=1 alacritty $cmd"
    else
        eval "alacritty $cmd"
    fi
}

_urxvt(){
    # check for dependencies
    command -v urxvt > /dev/null || { echo "urxvt not found"; exit 1; }
    
    cmd="$( echo "$@" | _replace "-t" "-title" | _replace "-c" "-name" )"
    eval "urxvt $cmd"
}

while test $# -gt 0; do
    case "$1" in
        # -h|--help) echo "$__usage"; exit ;;
        urxvt) shift; _urxvt "$@"; exit ;;
        *) _alacritty "$@"; exit ;;
    esac
    shift
done

_alacritty "$@"
