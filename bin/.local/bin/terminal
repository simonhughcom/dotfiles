#!/bin/sh

# TERMINAL
# Simon Hugh Moore
#
# Wrapper script for launching terminal

# check for dependency
_dep() {
    command -v "$1" > /dev/null || { echo "$1 not found"; exit 1; }
}

# Replace one cli command with another
_replace(){
    sed "s/[[:blank:]]*$1[[:blank:]][[:blank:]]*/ $2 /"
}

_alacritty(){
    _dep "alacritty"

    cmd="$( echo "$@" | _replace "-c" "--class" )"
    if [ "$HOST" = "mumtop" ]; then
        eval "LIBGL_ALWAYS_SOFTWARE=1 alacritty $cmd"
    else
        eval "alacritty $cmd"
    fi
}

_urxvt(){
    _dep "urxvt"
    
    cmd="$( echo "$@" | _replace "-t" "-title" | _replace "-c" "-name" )"
    eval "urxvt $cmd"
}

_xst(){
    _dep "xst"
    cmd="$( echo "$@" | _replace "-c" "-n" )"
    eval "xst $cmd"
}

while test $# -gt 0; do
    case "$1" in
        # -h|--help) echo "$__usage"; exit ;;
        urxvt) shift; _urxvt "$@"; exit ;;
        xst) shift; _xst "$@"; exit ;;
        alacritty) _alacritty "$@"; exit ;;
        *) _alacritty "$@"; exit ;;
    esac
    shift
done

_alacritty "$@"
