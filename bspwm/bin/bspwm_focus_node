#!/bin/sh

# BSPWM_FOCUS_NODE
# Simon Hugh Moore
#
# Correctly focus node dependent on layout. 

# Error message
_error() { echo "Use: $( basename $0) -f|s left|down|up|right" && exit 1; }

# get layout of focused window.
layout=$( bspc query -T -d | jq -r .layout )

# use correct command to focus node depending on layout.
case "$layout" in
    tiled) left="west"; down="south"; up="north"; right="east" ;;
    monocle) left="prev"; down="prev"; up="next"; right="next" ;; 
esac

# wrapper function for bspwm focus command.
_bf() { bspc node $1 $2.local; }

# error if first argument is not -f|s
[ "$1" != "-f" -a "$1" != "-s" ] && _error;

# get direction of focus.
case "$2" in
    l|left) _bf $1 $left;;
    d|down) _bf $1 $down;;
    u|up) _bf $1 $up;;
    r|right) _bf $1 $right;;
    *) _error ;;
esac
